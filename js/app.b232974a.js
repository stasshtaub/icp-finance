(function(e){function t(t){for(var a,u,s=t[0],l=t[1],o=t[2],d=0,m=[];d<s.length;d++)u=s[d],Object.prototype.hasOwnProperty.call(r,u)&&r[u]&&m.push(r[u][0]),r[u]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);i&&i(t);while(m.length)m.shift()();return c.push.apply(c,o||[]),n()}function n(){for(var e,t=0;t<c.length;t++){for(var n=c[t],a=!0,s=1;s<n.length;s++){var l=n[s];0!==r[l]&&(a=!1)}a&&(c.splice(t--,1),e=u(u.s=n[0]))}return e}var a={},r={app:0},c=[];function u(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,u),n.l=!0,n.exports}u.m=e,u.c=a,u.d=function(e,t,n){u.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},u.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},u.t=function(e,t){if(1&t&&(e=u(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(u.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)u.d(n,a,function(t){return e[t]}.bind(null,a));return n},u.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return u.d(t,"a",t),t},u.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},u.p="/icp-finance/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var o=0;o<s.length;o++)t(s[o]);var i=l;c.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("cd49")},"0f3e":function(e,t,n){"use strict";n("4e2b")},1891:function(e,t,n){"use strict";n("f4b6")},"3fa6":function(e,t,n){},4803:function(e,t,n){"use strict";n("b326")},"4e2b":function(e,t,n){},"539f":function(e,t,n){"use strict";n("3fa6")},"5c0b":function(e,t,n){"use strict";n("9c0c")},"7f75":function(e,t,n){"use strict";n("9370")},"85ad":function(e,t,n){"use strict";n("ffab")},9370:function(e,t,n){},"9c0c":function(e,t,n){},b326:function(e,t,n){},cd49:function(e,t,n){"use strict";n.r(t);n("5466"),n("450d");var a=n("ecdf"),r=n.n(a),c=(n("38a0"),n("ad41")),u=n.n(c),s=(n("eca7"),n("3787")),l=n.n(s),o=(n("425f"),n("4105")),i=n.n(o),d=(n("3c52"),n("0d7b")),m=n.n(d),p=(n("fe07"),n("6ac5")),f=n.n(p),y=(n("560b"),n("dcdc")),b=n.n(y),h=(n("10cb"),n("f3ad")),_=n.n(h),v=(n("826b"),n("c263")),O=n.n(v),j=(n("be4f"),n("896a")),P=n.n(j),g=(n("f4f9"),n("c2cc")),E=n.n(g),C=(n("7a0f"),n("0f6c")),w=n.n(C),T=(n("6611"),n("e772")),x=n.n(T),D=(n("1f1a"),n("4e4b")),S=n.n(D),A=(n("1951"),n("eedf")),N=n.n(A),k=(n("e260"),n("e6cf"),n("cca6"),n("a79d"),n("2b0e")),M=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}],staticClass:"layout",attrs:{id:"app"}},[n("FinanceHeader"),n("div",{staticClass:"layout__body"},[n(e.currentStep,{tag:"component",on:{"success-send":e.openControl}})],1)],1)},R=[],U=n("5530"),$=n("1da1"),Y=(n("96cf"),n("2f62")),L="GET_AUTH",H="GET_USER",F="GENERATE_SCHEDULE",B="CALC_PAYMENT_COUNT",I="CALC_PAYMENT_PER_PAYMENT",G="SEND_PAYMENTS",Z="GET_PAYMENTS",J="SET_AUTH",K="SET_USER",q="UPDATE_PAYMENT_MODEL",z="SET_PAYMENT_SCHEDULE",Q="UPDATE_PAYMENT_SCHEDULE_DAY",V="EMPTY_PAYMENT_SCHEDULE",W="SET_PAYMENTS",X=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("header",{staticClass:"finance-header"},[n("el-row",[n("el-col",{attrs:{span:4}},[n("UserInfo")],1),n("el-col",{attrs:{span:4}},[n("BalanceCard",{attrs:{balance:e.paid,type:"paid",align:"center"}},[e._v(" Оплачено ")])],1),n("el-col",{attrs:{span:4}},[n("BalanceCard",{attrs:{balance:e.debt,type:"debt",align:"center"}},[e._v(" Оставшийся долг ")])],1)],1)],1)},ee=[],te=function(){var e,t,n=this,a=n.$createElement,r=n._self._c||a;return r("div",{staticClass:"balance-card",class:(e={},e["balance-card--align--"+n.align]=n.align,e)},[r("h2",{staticClass:"balance-card__value",class:(t={},t["balance-card__value--type--"+n.type]=n.type,t)},[n._v(" "+n._s(n.formatCurrency(n.balance))+" ")]),r("div",{staticClass:"balance-card__body"},[n._t("default")],2)])},ne=[],ae=(n("a9e3"),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"RUB",n=new Intl.NumberFormat("ru-RU",{style:"currency",currency:t});return n.format(e)}),re={name:"BalanceCard",props:{balance:{type:Number,default:null},type:{type:String,default:null},align:{type:String,default:null}},methods:{formatCurrency:ae}},ce=re,ue=(n("4803"),n("2877")),se=Object(ue["a"])(ce,te,ne,!1,null,null,null),le=se.exports,oe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"user-info"},[e.user?[n("BalanceCard",{attrs:{balance:e.user.paymentAmount}},[n("p",{staticClass:"user-info__name"},[e._v(e._s(e.fullName))]),n("a",{staticClass:"user-info__email",attrs:{href:"mailto:"+e.user.email}},[e._v(e._s(e.user.email))])])]:e._e()],2)},ie=[],de=(n("99af"),{name:"UserInfo",components:{BalanceCard:le},computed:Object(U["a"])(Object(U["a"])({},Object(Y["e"])("user",{user:function(e){return e.data}})),{},{fullName:function(){var e=this.user;if(e)return"".concat(e.firstName," ").concat(e.lastName)}})}),me=de,pe=(n("85ad"),Object(ue["a"])(me,oe,ie,!1,null,null,null)),fe=pe.exports,ye={name:"FinanceHeader",components:{BalanceCard:le,UserInfo:fe},computed:Object(U["a"])({},Object(Y["c"])("paymentsControl",["paid","debt"]))},be=ye,he=Object(ue["a"])(be,X,ee,!1,null,null,null),_e=he.exports,ve=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"payment-settings"},[n("el-radio-group",{attrs:{disabled:e.isDisabled},model:{value:e.paymentType,callback:function(t){e.paymentType=t},expression:"paymentType"}},e._l(e.paymentTypes,(function(t){return n("el-radio-button",{key:t.value,attrs:{label:t.value}},[e._v(" "+e._s(t.label)+" ")])})),1),n("div",{staticClass:"payment-settings__content"},[n(e.currentTab,{tag:"component",on:{"success-send":function(t){return e.$emit("success-send")}}})],1)],1)},Oe=[],je=n("ade3");n("4de4"),n("ac1f"),n("1276"),n("5319");function Pe(e,t){return t.replace(/\./g,"/").split("/").filter(Boolean).reduce((function(e,t){return e[t]}),e)}function ge(e){return function(t,n){return"string"!==typeof t?(n=t,t=""):"/"!==t.charAt(t.length-1)&&(t+="/"),e(t,n)}}var Ee,Ce,we=ge((function(e,t){var n=t.fields,a=t.base,r=t.action,c=t.mutation;return n.reduce((function(t,n){return t[n]={get:function(){var t;return a=null!==(t=a)&&void 0!==t?t:"",Pe(this.$store.state,e+a)[n]},set:function(t){r&&this.$store.dispatch(e+r,Object(je["a"])({},n,t)).then(),c&&(console.warn("mutation param is deprecated, use action instead"),this.$store.commit(e+c,Object(je["a"])({},n,t)))}},t}),{})})),Te={methods:{updateData:function(){this.$store.dispatch("user/".concat(H)),this.$store.dispatch("paymentsControl/".concat(Z))}}},xe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-row",[n("el-button",{attrs:{type:"success"},on:{click:e.sendReport}},[e._v(" Отправить отчёт ")]),n("el-button",{attrs:{type:"primary"},on:{click:e.updateData}},[e._v(" Обновить данные ")])],1)},De=[],Se={name:"FullPaymentTab",mixins:[Te],methods:{sendReport:function(){console.log("Implement sendReport")}}},Ae=Se,Ne=Object(ue["a"])(Ae,xe,De,!1,null,null,null),ke=Ne.exports,Me=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-form",[n("el-row",[n("el-col",{attrs:{span:14}},[n("PaymentCount")],1)],1),n("el-row",[n("el-col",{attrs:{span:14}},[e.hasSchedule?n("PaymentSchedule"):e._e()],1)],1),n("el-row",[e.hasSchedule?[n("el-button",{attrs:{type:"success",loading:e.isLoading},on:{click:e.startSend}},[e._v(" Начать отправку ")]),n("el-button",{attrs:{type:"info"},on:{click:e.EMPTY_PAYMENT_SCHEDULE}},[e._v(" Отменить ")])]:n("el-button",{attrs:{type:"success",disabled:e.isScheduleDisabled},on:{click:e.GENERATE_SCHEDULE}},[e._v(" Сформировать график ")]),n("el-button",{attrs:{type:"primary"},on:{click:e.updateData}},[e._v(" Обновить данные ")])],2)],1)},Re=[],Ue=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"payment-count"},[n("el-row",{attrs:{type:"flex",gutter:8}},[n("el-col",{attrs:{span:8}},[n("el-form-item",[n("CustomPlaceholder",{attrs:{value:e.paymentCount,placeholder:"Количество платежей"}},[n("el-select",{attrs:{placeholder:"Количество платежей",disabled:e.isDisabled},on:{change:e.CALC_PAYMENT_PER_PAYMENT},model:{value:e.paymentCount,callback:function(t){e.paymentCount=t},expression:"paymentCount"}},e._l(e.paymentCounts,(function(e){return n("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1)],1)],1),n("el-col",{attrs:{span:8}},[n("el-form-item",[n("CustomPlaceholder",{attrs:{value:e.perPayment,placeholder:"По"}},[n("el-input",{attrs:{placeholder:"По",disabled:e.isDisabled},on:{input:e.CALC_PAYMENT_COUNT},model:{value:e.perPayment,callback:function(t){e.perPayment=e._n(t)},expression:"perPayment"}},[n("span",{attrs:{slot:"suffix"},slot:"suffix"},[e._v("Р")])])],1)],1)],1)],1),n("el-row",{attrs:{type:"flex",align:"middle",gutter:8}},[n("el-col",{attrs:{span:8}},[n("el-checkbox",{attrs:{disabled:e.isDisabled},model:{value:e.withFirstPayment,callback:function(t){e.withFirstPayment=t},expression:"withFirstPayment"}},[e._v(" Первый платёж ")])],1),n("el-col",{attrs:{span:8}},[n("el-form-item",[n("el-input",{attrs:{placeholder:"Введите сумму",disabled:e.isDisabled||!e.withFirstPayment},model:{value:e.firstPayment,callback:function(t){e.firstPayment=e._n(t)},expression:"firstPayment"}},[n("span",{attrs:{slot:"suffix"},slot:"suffix"},[e._v("Р")])])],1)],1)],1)],1)},$e=[],Ye=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"custom-placeholder"},[e._t("default"),n("span",{staticClass:"custom-placeholder__label",class:{"custom-placeholder__label--active":e.isActive}},[e._v(" "+e._s(e.placeholder)+" ")])],2)},Le=[],He={name:"CustomPlaceholder",props:{placeholder:{type:String,default:null},value:{default:null}},computed:{isActive:function(){return null!=this.value&&""!==this.value}}},Fe=He,Be=(n("539f"),Object(ue["a"])(Fe,Ye,Le,!1,null,null,null)),Ie=Be.exports,Ge={name:"PaymentCount",components:{CustomPlaceholder:Ie},computed:Object(U["a"])(Object(U["a"])(Object(U["a"])(Object(U["a"])({},Object(Y["e"])("payment",{isDisabled:function(e){return null!=e.model.schedule}})),Object(Y["c"])("payment",["paymentCounts"])),we("payment",{fields:["paymentCount","perPayment","firstPayment"],base:"model",action:q})),{},{withFirstPayment:{get:function(){return null!=this.firstPayment},set:function(e){this.firstPayment=e?0:null}}}),methods:Object(U["a"])({},Object(Y["b"])("payment",[B,I]))},Ze=Ge,Je=(n("0f3e"),Object(ue["a"])(Ze,Ue,$e,!1,null,"1cbe3b91",null)),Ke=Je.exports,qe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"payment-schedule"},[n("h4",[e._v("График платежей")]),n("ol",{staticClass:"payment-schedule__list"},[e._l(e.schedule,(function(t,a){return n("li",{key:a,staticClass:"payment-schedule__item"},[n("PyamentDay",{attrs:{date:e.schedule[a].date,payment:e.schedule[a].payment,"last-payment":e.lastPayment,"total-payment":e.paymentAmount},on:{"update:date":[function(t){return e.$set(e.schedule[a],"date",t)},function(t){return e.updateDate(t,a)}],"update:payment":[function(t){return e.$set(e.schedule[a],"payment",t)},function(t){return e.updatePayment(t,a)}]}})],1)})),n("li",{staticClass:"payment-schedule__item"},[n("PyamentDay",{attrs:{date:e.lastPaymentDate,payment:e.lastPayment,"disabled-payment":""},on:{"update:date":function(t){e.lastPaymentDate=t}}})],1)],2)])},ze=[],Qe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-row",{staticClass:"payment-day",attrs:{gutter:12}},[n("el-col",{attrs:{span:8}},[n("el-form-item",[n("el-input",{attrs:{placeholder:"Введите сумму",min:0,disabled:e.disabledPayment},model:{value:e._payment,callback:function(t){e._payment=e._n(t)},expression:"_payment"}},[n("span",{attrs:{slot:"suffix"},slot:"suffix"},[e._v("Р")])])],1)],1),n("el-col",{attrs:{span:8}},[n("el-form-item",[n("el-date-picker",{attrs:{type:"date",placeholder:"Выберите дату"},model:{value:e._date,callback:function(t){e._date=t},expression:"_date"}})],1)],1)],1)},Ve=[],We={name:"PyamentDay",props:{date:{type:Date,default:null},payment:{type:Number,default:null},disabledPayment:{type:Boolean,default:!1},lastPayment:{type:Number,default:null},totalPayment:{type:Number,default:null}},computed:{_date:{get:function(){return this.date},set:function(e){this.$emit("update:date",e)}},_payment:{get:function(){return this.payment},set:function(e){this.$emit("update:payment",e)}}}},Xe=We,et=Object(ue["a"])(Xe,Qe,Ve,!1,null,"d389ccb0",null),tt=et.exports,nt={name:"PaymentSchedule",components:{PyamentDay:tt},computed:Object(U["a"])(Object(U["a"])(Object(U["a"])(Object(U["a"])({},we("payment",{fields:["lastPaymentDate"],base:"model",action:q})),Object(Y["e"])("payment",{schedule:function(e){return e.model.schedule}})),Object(Y["e"])("user",{paymentAmount:function(e){return e.data.paymentAmount}})),Object(Y["c"])("payment",["lastPayment"])),methods:Object(U["a"])(Object(U["a"])({},Object(Y["b"])("payment",[Q])),{},{updateDate:function(e,t){this.UPDATE_PAYMENT_SCHEDULE_DAY({index:t,day:{date:e}})},updatePayment:function(e,t){this.UPDATE_PAYMENT_SCHEDULE_DAY({index:t,day:{payment:e}})},isPaymentDisabled:function(e){return e===this.schedule.length-1}})},at=nt,rt=(n("1891"),Object(ue["a"])(at,qe,ze,!1,null,"2b375962",null)),ct=rt.exports,ut={name:"InstalmentsTab",mixins:[Te],components:{PaymentCount:Ke,PaymentSchedule:ct},computed:Object(U["a"])(Object(U["a"])({},Object(Y["e"])("payment",{hasSchedule:function(e){return e.model.schedule&&"instalments"===e.model.paymentType},isScheduleDisabled:function(e){return null==e.model.paymentCount}})),{},{isLoading:function(){return this.$wait("payment/".concat(G))}}),methods:Object(U["a"])(Object(U["a"])(Object(U["a"])({},Object(Y["b"])("payment",[B,F,G])),Object(Y["d"])("payment",[V])),{},{startSend:function(){var e=this;return Object($["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.SEND_PAYMENTS();case 2:e.$emit("success-send");case 3:case"end":return t.stop()}}),t)})))()}})},st=ut,lt=Object(ue["a"])(st,Me,Re,!1,null,null,null),ot=lt.exports,it={name:"PaymentSettings",mixins:[Te],components:{FullPaymentTab:ke,InstalmentsTab:ot},data:function(){return{tabs:{instalments:"InstalmentsTab",full:"FullPaymentTab"}}},computed:Object(U["a"])(Object(U["a"])(Object(U["a"])({},Object(Y["e"])("payment",{paymentTypes:function(e){return e.options.paymentTypes},isDisabled:function(e){return null!=e.model.schedule}})),we("payment",{fields:["paymentType"],base:"model",action:q})),{},{currentTab:function(){return this.tabs[this.paymentType]}})},dt=it,mt=(n("7f75"),Object(ue["a"])(dt,ve,Oe,!1,null,null,null)),pt=mt.exports,ft=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-row",[n("el-table",{attrs:{data:e.payments}},[n("el-table-column",{attrs:{align:"center",type:"index",label:"№",width:"50"}}),n("el-table-column",{attrs:{align:"center",prop:"payment",label:"Сумма"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[e._v(" "+e._s(e.formatCurrency(n.payment))+" ")]}}])}),n("el-table-column",{attrs:{align:"center",prop:"invoiceDate",label:"Дата счёта"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[e._v(" "+e._s(e.formatDate(n.invoiceDate))+" ")]}}])}),n("el-table-column",{attrs:{align:"center",prop:"status",label:"Статус"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[e._v(" "+e._s(e.translations.status[n.status])+" ")]}}])}),n("el-table-column",{attrs:{align:"center",prop:"paymentDate",label:"Дата оплаты"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[e._v(" "+e._s(e.formatDate(n.paymentDate))+" ")]}}])}),n("el-table-column",{attrs:{align:"center",label:"Действия"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e.hasAction(a.status)?n("el-button",{attrs:{type:"text"},on:{click:function(t){return e.actionByRow(a)}}},[e._v(" "+e._s(e.getActionText(a.status))+" ")]):e._e()]}}])})],1)],1),n("el-row",[n("el-button",{attrs:{type:"primary"},on:{click:e.updateData}},[e._v(" Обновить данные ")])],1)],1)},yt=[],bt=(n("fb6a"),function(e){return e?new Date(e).toLocaleString().slice(0,-3).replace(",",""):null}),ht={name:"PaymentsControl",mixins:[Te],data:function(){return{translations:{status:{paid:"Оплачен",sent:"Оптравлен"}}}},computed:Object(U["a"])({},Object(Y["e"])("paymentsControl",{payments:function(e){var t=e.data;return t.items}})),methods:{resend:function(e){console.warn("Implement 'resend' method")},sendNow:function(e){console.warn("Implement 'sendNow' method")},hasAction:function(e){return"paid"!==e},getActionText:function(e){switch(e){case"sent":return"отправить повторно";default:return"отправить сейчас"}},actionByRow:function(e){switch(e.status){case"sent":this.resend(e);break;default:this.sendNow(e)}},formatCurrency:ae,formatDate:bt}},_t=ht,vt=Object(ue["a"])(_t,ft,yt,!1,null,null,null),Ot=vt.exports,jt={name:"App",components:{FinanceHeader:_e,PaymentSettings:pt,PaymentsControl:Ot},created:function(){var e=this;return Object($["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.GET_AUTH();case 2:return e.GET_USER(),t.next=5,e.GET_PAYMENTS();case 5:case"end":return t.stop()}}),t)})))()},data:function(){return{currentStep:"PaymentSettings"}},computed:Object(U["a"])(Object(U["a"])({},Object(Y["e"])("paymentsControl",{hasTable:function(e){return e.data.items.length>0}})),{},{isLoading:function(){return this.$wait("auth/".concat(L))||this.$wait("user/".concat(H))}}),methods:Object(U["a"])(Object(U["a"])(Object(U["a"])(Object(U["a"])(Object(U["a"])(Object(U["a"])({},Object(Y["b"])("auth",[L])),Object(Y["b"])("user",[H])),Object(Y["b"])("payment",[F])),Object(Y["b"])("paymentsControl",[Z])),Object(Y["d"])("payment",[V])),{},{openControl:function(){this.currentStep="PaymentsControl"}})},Pt=jt,gt=(n("5c0b"),Object(ue["a"])(Pt,M,R,!1,null,null,null)),Et=gt.exports,Ct=n("d4ec"),wt=n("bee2"),Tt=(n("d3b7"),{ACCESS_TOKEN:"f501215d003d7e84003d7e8200000001100e03dc37a458d34295efbd236acf1d3e6cc7",DOMAIN:"b24-gx7djf.bitrix24.ru",MEMBER_ID:"10aa3c0406bae7b5dbba1d87164f4a8f",REFRESH_TOKEN:"e580485d003d7e84003d7e8200000001100e03c1685c8a1a76097df895324671373e09"}),xt=function(){function e(){Object(Ct["a"])(this,e)}return Object(wt["a"])(e,null,[{key:"auth",value:function(){return new Promise((function(e){setTimeout((function(){e(Tt)}),500)}))}}]),e}(),Dt=function(){return{data:null}},St=Object(je["a"])({},J,(function(e,t){e.data=t})),At=Object(je["a"])({},L,(function(e){return Object($["a"])(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.commit,t.next=3,xt.auth();case 3:a=t.sent,n(J,a);case 5:case"end":return t.stop()}}),t)})))()})),Nt={namespaced:!0,state:Dt,actions:At,mutations:St},kt=n("262e"),Mt=n("2caf"),Rt=function e(){Object(Ct["a"])(this,e)},Ut={email:"yuliapolunosik@mail.ru",firstName:"Юлия",lastName:"Полуносик",paymentAmount:15e4},$t=function(e){Object(kt["a"])(n,e);var t=Object(Mt["a"])(n);function n(){return Object(Ct["a"])(this,n),t.apply(this,arguments)}return Object(wt["a"])(n,null,[{key:"getUser",value:function(){return new Promise((function(e){setTimeout((function(){e({data:Ut})}),500)}))}}]),n}(Rt),Yt=function(){return{data:null}},Lt=Object(je["a"])({},K,(function(e,t){e.data=t})),Ht=Object(je["a"])({},H,(function(e){return Object($["a"])(regeneratorRuntime.mark((function t(){var n,a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.commit,t.next=3,$t.getUser();case 3:a=t.sent,r=a.data,n(K,r);case 6:case"end":return t.stop()}}),t)})))()})),Ft={namespaced:!0,state:Yt,actions:Ht,mutations:Lt},Bt=n("2909"),It=(n("ddb0"),n("d81d"),function e(t,n){Object(Ct["a"])(this,e),this.payment=t,this.date=n}),Gt=function(e){Object(kt["a"])(n,e);var t=Object(Mt["a"])(n);function n(){return Object(Ct["a"])(this,n),t.apply(this,arguments)}return Object(wt["a"])(n,null,[{key:"sendPayments",value:function(e){return new Promise((function(e){setTimeout(e,500)}))}}]),n}(Rt),Zt=function(){return{model:{paymentType:"full",paymentCount:null,perPayment:null,firstPayment:null,schedule:null,lastPaymentDate:null},options:{paymentTypes:[{value:"full",label:"Вся сумма"},{value:"instalments",label:"Рассрочка"}],maxPayments:12}}},Jt=Zt,Kt={paymentCounts:function(e){return Object(Bt["a"])(Array(e.options.maxPayments+1).keys()).slice(2)},lastPayment:function(e,t,n){var a=e.model.schedule,r=n.user.data.paymentAmount;if(a){var c=a.filter((function(e){return e.payment})).reduce((function(e,t){return e+t.payment}),0);return r-c}return r}},qt=(Ee={},Object(je["a"])(Ee,q,(function(e,t){e.model=Object(U["a"])(Object(U["a"])({},e.model),t)})),Object(je["a"])(Ee,z,(function(e,t){e.model.schedule=t})),Object(je["a"])(Ee,Q,(function(e,t){var n,a=t.index,r=t.day;null!==(n=e.model.schedule)&&void 0!==n&&n[a]&&k["default"].set(e.model.schedule,a,Object(U["a"])(Object(U["a"])({},e.model.schedule[a]),r))})),Object(je["a"])(Ee,V,(function(e){e.model.schedule=Zt().model.schedule})),Ee),zt=(Ce={},Object(je["a"])(Ce,B,(function(e){var t=e.commit,n=e.state,a=e.rootState,r=n.model,c=r.paymentCount,u=r.perPayment,s=n.options.maxPayments;if(null==c&&null!=u){var l=a.user.data.paymentAmount,o=l/u,i=Math.ceil(o);i<=s&&t(q,{paymentCount:i})}})),Object(je["a"])(Ce,I,(function(e){var t=e.commit,n=e.state,a=e.rootState,r=n.model,c=r.paymentCount,u=r.perPayment;if(null==u&&null!=c){var s=a.user.data.paymentAmount,l=s/c,o=Math.floor(l);t(q,{perPayment:o})}})),Object(je["a"])(Ce,F,(function(e){var t=e.commit,n=e.state,a=n.model,r=a.paymentCount,c=a.perPayment,u=a.firstPayment;if(r){var s=new Date,l=Object(Bt["a"])(Array(r-1)).map((function(e,t){var n=0===t&&null!=u?u:c,a=s.getMonth()+t,r=new Date(s);return r.setMonth(a),new It(n,r)})),o=l[l.length-1].date,i=new Date;i.setMonth(o.getMonth()+1),t(z,l),t(q,{lastPaymentDate:i})}})),Object(je["a"])(Ce,G,(function(e){return Object($["a"])(regeneratorRuntime.mark((function t(){var n,a,r,c,u,s,l,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.state,a=e.getters,r=n.model,c=r.schedule,u=r.lastPaymentDate,s=a.lastPayment,l=new It(s,u),o=[].concat(Object(Bt["a"])(c),[l]),t.next=7,Gt.sendPayments(o);case 7:case"end":return t.stop()}}),t)})))()})),Object(je["a"])(Ce,q,(function(e,t){var n=e.commit;n(q,t)})),Object(je["a"])(Ce,Q,(function(e,t){var n=e.commit,a=t.index,r=t.day;n(Q,{index:a,day:r})})),Ce),Qt={namespaced:!0,state:Jt,getters:Kt,mutations:qt,actions:zt},Vt={items:[{invoiceDate:"2021-05-06T21:56:14Z",paymentDate:"2021-06-06T21:56:14Z",payment:3e4,status:"paid"},{invoiceDate:"2021-05-06T21:56:14Z",payment:2e4,status:"sent"},{invoiceDate:"2021-05-06",payment:6e4}],count:0},Wt=function(e){Object(kt["a"])(n,e);var t=Object(Mt["a"])(n);function n(){return Object(Ct["a"])(this,n),t.apply(this,arguments)}return Object(wt["a"])(n,null,[{key:"getPayments",value:function(){return new Promise((function(e){setTimeout((function(){e({data:Vt})}),500)}))}}]),n}(Rt),Xt=function(){return{data:{items:[],count:0}}},en=Xt,tn={paid:function(e){return e.data.items.filter((function(e){var t=e.status;return"paid"===t})).reduce((function(e,t){var n=t.payment;return e+n}),0)},debt:function(e,t,n){var a,r,c=null===(a=n.user)||void 0===a||null===(r=a.data)||void 0===r?void 0:r.paymentAmount;if(null!=c){var u=t.paid;return c-u}}},nn=Object(je["a"])({},W,(function(e,t){e.data=t})),an=Object(je["a"])({},Z,(function(e){return Object($["a"])(regeneratorRuntime.mark((function t(){var n,a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.commit,t.next=3,Wt.getPayments();case 3:a=t.sent,r=a.data,n(W,r);case 6:case"end":return t.stop()}}),t)})))()})),rn={namespaced:!0,state:en,getters:tn,mutations:nn,actions:an};k["default"].use(Y["a"]);var cn=new Y["a"].Store({modules:{auth:Nt,user:Ft,payment:Qt,paymentsControl:rn}}),un=n("d83e"),sn=n("dccd"),ln=n.n(sn),on=n("4897"),dn=n.n(on);n("0fae");k["default"].config.productionTip=!1,dn.a.use(ln.a),k["default"].use(N.a),k["default"].use(S.a),k["default"].use(x.a),k["default"].use(w.a),k["default"].use(E.a),k["default"].use(P.a.directive),k["default"].use(O.a,{locale:dn.a}),k["default"].use(_.a),k["default"].use(b.a),k["default"].use(f.a),k["default"].use(m.a),k["default"].use(i.a),k["default"].use(l.a),k["default"].use(u.a),k["default"].use(r.a),k["default"].use(un["a"],{store:cn}),new k["default"]({store:cn,render:function(e){return e(Et)}}).$mount("#app")},f4b6:function(e,t,n){},ffab:function(e,t,n){}});
//# sourceMappingURL=app.b232974a.js.map